# LLM Tab Grouper

A Chrome extension that automatically groups open tabs by topic using Google Gemini. The user supplies their own Gemini API key, which is stored locally via `chrome.storage` and never leaves the device except for requests sent directly to the Gemini API.

## Features
- Prompt for an API key before grouping tabs.
- Collects open tab metadata (title and URL) and sends it to Google Gemini for grouping suggestions.
- Creates tab groups and applies suggested titles and colors.
- **Smart grouping modes:**
  - **Default mode (unchecked):** Only groups ungrouped tabs, preserving existing groups. The LLM can add new tabs to existing groups or create new ones.
  - **Regroup all mode (checked):** Regroups all tabs from scratch, including those already grouped.
- Uses the OpenAI-compatible API interface with Google Gemini for reliable API communication.

## Development

### Prerequisites
- Node.js (v18 or higher)
- npm

### Building the Extension
1. Install dependencies:
   ```bash
   npm install
   ```

2. Build the extension:
   ```bash
   npm run build
   ```
   This will bundle the source files from `src/` into the `dist/` directory.

### Project Structure
- `src/` - Source code (uses the OpenAI library and ES modules)
- `dist/` - Built extension files (generated by the build script)
- `build.js` - Build script that bundles the extension using esbuild

## Installation
1. Build the extension (see Development section above).
2. Open the browser's extension management page (`chrome://extensions`).
3. Enable **Developer mode**.
4. Use **Load unpacked** to select the `dist/` folder.
5. Click the extension icon in your browser toolbar.
6. Click "Set API Key" and enter your Gemini API key from [Google AI Studio](https://aistudio.google.com/app/apikey).
7. Click "Save" and then press **Group Tabs** to trigger grouping.

## Implementation Notes
- Uses the [OpenAI JavaScript library](https://platform.openai.com/docs/libraries) with Google Gemini's OpenAI-compatible API endpoint.
- The Gemini API is called with the `gemini-2.0-flash-lite` model by default. You can adjust the `GEMINI_MODEL` constant in `src/background.js`.
- Tabs are grouped according to the JSON structure returned by the LLM. Invalid responses will surface an error in the popup.
- Pinned tabs are left untouched to avoid disrupting the user's workspace.
- When "Regroup all" is unchecked (default):
  - Only ungrouped tabs are processed
  - Existing groups remain intact
  - The LLM receives information about existing groups and can add new tabs to them or create new groups
  - New tabs are appended to the end of existing groups when assigned to them
- When "Regroup all" is checked:
  - All tabs are ungrouped and regrouped from scratch based on the LLM's suggestions
- The checkbox state is persisted in local storage for convenience.

## Privacy
- The API key is saved in local extension storage. Clear it from the options page at any time.
- Only the minimal tab metadata required for grouping (title and URL) is sent to Google Gemini.

## Limitations
- Requires an active internet connection and a valid Gemini API key with sufficient quota.
- The accuracy of grouping depends on the quality of the LLM response.
